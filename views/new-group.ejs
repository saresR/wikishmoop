<%- include('partials/header'); -%>

<div class="padding">
  <h2>New article group</h2>
  <div class="smaller-br"></div>
  <form class="text-left" action="/new-group" method="post" id="form">
    <div class="form-group">
      <p>Subject</p>
      <select class="form-control" name="subject" style="margin: 0;" required>
        <option value="English">English</option>
        <option value="Math">Math</option>
        <option value="Science">Science</option>
        <option value="History">History</option>
        <option value="Other">Other</option>
      </select>
    </div>
    <div class="smaller-br"></div>
  <div class="form-group">
    <p>Group name</p>
    <input class="form-control" type="text" name="title" placeholder = "e.g. Algebra, US History, Chemistry" id="title" required>
    <div class="smaller-br"></div>
    <label for="title">
      Already existing groups:
      <% groups.forEach(function(group){ %>
        <span class="group-name"><%= group %></span>,
      <%}); %>
    </label>
  </div>
  <div class="smaller-br"></div>
  <div class="form-group">
    <p>Description</p>
    <textarea class="form-control" type="text" name="description" placeholder = "This can be edited later" id="description"></textarea>
  </div>
  <div class="smaller-br"></div>
  <button type="button" onclick="confirmSubmit();" class="btn btn-info">Submit</button>

  </form>
</div>

<%- include('partials/footer'); -%>

<script type="text/javascript">
  function confirmSubmit(){
    let done = false;
    $(".group-name").each(function(){
      if ($(this).html().toLowerCase() === $("#title").val().toLowerCase()){
        alert("A group with the same name already exists!");
        done = true;
        return false;
      }
    });
    setTimeout(function () {
      if (done === false) {
        console.log("hey");
        $("#form").submit();
      }
    }, 10);
  }

</script>
